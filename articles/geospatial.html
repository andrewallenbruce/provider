<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Demographics, Patient Mix, and Performance">
<title>Mapping Providers â€¢ provider</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Sans-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Kanit-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Mapping Providers">
<meta property="og:description" content="Demographics, Patient Mix, and Performance">
<meta property="og:image" content="https://andrewallenbruce.github.io/provider/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">provider</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9012</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/provider.html">Getting started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/linking-providers.html">Profiling Providers</a>
    <a class="dropdown-item" href="../articles/partb-stats.html">Comparing Providers</a>
    <a class="dropdown-item" href="../articles/geospatial.html">Mapping Providers</a>
    <a class="dropdown-item" href="../articles/networks.html">Linking Providers</a>
    <a class="dropdown-item" href="../articles/qpp.html">Quality Payment Program</a>
    <a class="dropdown-item" href="../articles/open.html">Open Payments</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
    
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="far fa far fa-newspaper fa-lg"></span>
     
    
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/andrewallenbruce/provider">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/aabrucehimni">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/andybruce1/">
    <span class="fas fa fas fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Mapping Providers</h1>
            <h3 data-toc-skip class="subtitle">Demographics, Patient
Mix, and Performance</h3>
                        <h4 data-toc-skip class="author">Andrew
Bruce</h4>
            
            <h4 data-toc-skip class="date">2023-11-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewallenbruce/provider/blob/HEAD/vignettes/articles/geospatial.Rmd" class="external-link"><code>vignettes/articles/geospatial.Rmd</code></a></small>
      <div class="d-none name"><code>geospatial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="load-packages">Load Packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewallenbruce.github.io/provider/">provider</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jessecambon.github.io/tidygeocoder/" class="external-link">tidygeocoder</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yutannihilation.github.io/ggsflabel/" class="external-link">ggsflabel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yutannihilation.github.io/gghighlight/" class="external-link">gghighlight</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris" class="external-link">tigris</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gavinrozzi/zipcodeR/" class="external-link">zipcodeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fipio.justinsingh.me" class="external-link">fipio</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error in library(fipio): there is no package called 'fipio'</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="retrieve-npis-of-all-rhcs-in-georgia">Retrieve NPIs of all RHCs in Georgia<a class="anchor" aria-label="anchor" href="#retrieve-npis-of-all-rhcs-in-georgia"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rhcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/providers.html">providers</a></span><span class="op">(</span>state <span class="op">=</span> <span class="st">"GA"</span>, specialty_code <span class="op">=</span> <span class="st">"00-17"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">npi</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">npi</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/nppes.html">nppes</a></span><span class="op">(</span>npi <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">npi</span>,</span>
<span>                <span class="va">organization</span>, </span>
<span>                <span class="va">tx_desc</span>,</span>
<span>                <span class="va">org_part</span>,</span>
<span>                <span class="va">purpose</span>,</span>
<span>                <span class="va">org_parent</span>,</span>
<span>                <span class="va">on_type</span>,</span>
<span>                <span class="va">on_org_name</span>,</span>
<span>                <span class="va">address</span>, </span>
<span>                <span class="va">city</span>, </span>
<span>                <span class="va">state</span>, </span>
<span>                <span class="va">zip</span>,</span>
<span>                <span class="va">pr_purpose</span>, </span>
<span>                <span class="va">pr_address</span>, </span>
<span>                <span class="va">pr_city</span>, </span>
<span>                <span class="va">pr_state</span>, </span>
<span>                <span class="va">pr_zip</span><span class="op">)</span></span>
<span><span class="va">rhcs</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 197 Ã— 17</span></span></span>
<span><span class="co">#&gt;    npi      organization tx_desc org_part purpose org_parent on_type on_org_name</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1992710â€¦ TMC HARALSOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1992710â€¦ TMC HARALSOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1992710â€¦ TMC HARALSOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1992710â€¦ TMC HARALSOâ€¦ Clinicâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1992710â€¦ TMC HARALSOâ€¦ Clinicâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1992710â€¦ TMC HARALSOâ€¦ Clinicâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         Doing â€¦ PRIMARY CAâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1497760â€¦ TMC TALLAPOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1497760â€¦ TMC TALLAPOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1497760â€¦ TMC TALLAPOâ€¦ Familyâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1497760â€¦ TMC TALLAPOâ€¦ Clinicâ€¦ FALSE    PRACTIâ€¦ <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 187 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 9 more variables: address &lt;chr&gt;, city &lt;chr&gt;, state &lt;ord&gt;, zip &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pr_purpose &lt;chr&gt;, pr_address &lt;chr&gt;, pr_city &lt;chr&gt;, pr_state &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   pr_zip &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="retrieve-counties-from-zip-codes-with-zipcoder">Retrieve Counties from Zip codes with <code>{zipcodeR}</code><a class="anchor" aria-label="anchor" href="#retrieve-counties-from-zip-codes-with-zipcoder"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zip_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="fu">zipcodeR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/zipcodeR/man/zip_code_db.html" class="external-link">zip_code_db</a></span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">"GA"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>zip <span class="op">=</span> <span class="va">zipcode</span>, </span>
<span>                city <span class="op">=</span> <span class="va">major_city</span>, </span>
<span>                <span class="va">county</span>, </span>
<span>                <span class="va">state</span>, </span>
<span>                <span class="va">lat</span>, </span>
<span>                <span class="va">lng</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>county <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">county</span>, <span class="st">" County"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">zip_db</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 973 Ã— 6</span></span></span>
<span><span class="co">#&gt;    zip   city             county   state   lat   lng</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 30002 Avondale Estates DeKalb   GA     33.8 -<span style="color: #BB0000;">84.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 30003 Norcross         Gwinnett GA     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 30004 Alpharetta       Fulton   GA     34.1 -<span style="color: #BB0000;">84.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30005 Alpharetta       Fulton   GA     34.1 -<span style="color: #BB0000;">84.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 30006 Marietta         Cobb     GA     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 30007 Marietta         Cobb     GA     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 30008 Marietta         Cobb     GA     33.9 -<span style="color: #BB0000;">84.6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 30009 Alpharetta       Fulton   GA     34.1 -<span style="color: #BB0000;">84.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 30010 Norcross         Gwinnett GA     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 30011 Auburn           Barrow   GA     34.0 -<span style="color: #BB0000;">83.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 963 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="stack-distinct-location-practice-addresses">Stack Distinct <code>LOCATION</code> &amp; <code>PRACTICE</code>
Addresses<a class="anchor" aria-label="anchor" href="#stack-distinct-location-practice-addresses"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stack</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rhcs</span>, </span>
<span>                <span class="va">npi</span>,</span>
<span>                <span class="va">organization</span>, </span>
<span>                <span class="va">tx_desc</span>,</span>
<span>                <span class="va">org_part</span>,</span>
<span>                <span class="va">purpose</span>,</span>
<span>                <span class="va">org_parent</span>,</span>
<span>                <span class="va">on_type</span>,</span>
<span>                <span class="va">on_org_name</span>,</span>
<span>                <span class="va">address</span>, </span>
<span>                <span class="va">city</span>, </span>
<span>                <span class="va">state</span>, </span>
<span>                <span class="va">zip</span><span class="op">)</span>,</span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rhcs</span>, </span>
<span>                <span class="va">npi</span>, </span>
<span>                <span class="va">organization</span>, </span>
<span>                <span class="va">tx_desc</span>,</span>
<span>                <span class="va">org_part</span>,</span>
<span>                purpose <span class="op">=</span> <span class="va">pr_purpose</span>, </span>
<span>                <span class="va">org_parent</span>,</span>
<span>                <span class="va">on_type</span>,</span>
<span>                <span class="va">on_org_name</span>,</span>
<span>                address <span class="op">=</span> <span class="va">pr_address</span>, </span>
<span>                city <span class="op">=</span> <span class="va">pr_city</span>, </span>
<span>                state <span class="op">=</span> <span class="va">pr_state</span>, </span>
<span>                zip <span class="op">=</span> <span class="va">pr_zip</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>zip <span class="op">=</span> <span class="fu">zipcodeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zipcodeR/man/normalize_zip.html" class="external-link">normalize_zip</a></span><span class="op">(</span><span class="va">zip</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">purpose</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>specialty <span class="op">=</span> <span class="va">tx_desc</span>, </span>
<span>              other_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">org_parent</span>, </span>
<span>                              <span class="va">on_type</span>, </span>
<span>                              <span class="va">on_org_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="st">"address"</span>, </span>
<span>               <span class="va">address</span><span class="op">:</span><span class="va">state</span>, </span>
<span>               remove <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">zip_db</span><span class="op">)</span> <span class="co"># Join RHCs to Counties</span></span>
<span><span class="va">stack</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 91 Ã— 13</span></span></span>
<span><span class="co">#&gt;    npi   organization org_part purpose address zip   specialty other_names city </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1992â€¦ TMC HARALSOâ€¦ FALSE    PRACTIâ€¦ 204 ALâ€¦ 30110 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Bremâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1497â€¦ TMC TALLAPOâ€¦ FALSE    PRACTIâ€¦ 25 W Lâ€¦ 30176 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Tallâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1285â€¦ HIAWASSEE Fâ€¦ FALSE    PRACTIâ€¦ 56 HOSâ€¦ 30546 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Hiawâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1982â€¦ TMC WEST CAâ€¦ FALSE    PRACTIâ€¦ 1125 Eâ€¦ 30108 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Bowdâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1821â€¦ BACON COUNTâ€¦ FALSE    PRACTIâ€¦ 204 E â€¦ 31510 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Alma </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1750â€¦ BOWDON- MT.â€¦ TRUE     PRACTIâ€¦ 41 WELâ€¦ 30185 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Whitâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1366â€¦ HOSPITAL AUâ€¦ FALSE    PRACTIâ€¦ 25 PERâ€¦ 31730 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Camiâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1891â€¦ THE MEDICALâ€¦ FALSE    PRACTIâ€¦ 109 COâ€¦ 30635 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Elbeâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1578â€¦ UNION COUNTâ€¦ FALSE    PRACTIâ€¦ 178 A â€¦ 30512 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Blaiâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1922â€¦ HOSPITAL AUâ€¦ FALSE    PRACTIâ€¦ 259 USâ€¦ 31730 <span style="color: #949494;">&lt;tibble&gt;</span>  <span style="color: #949494;">&lt;tibble&gt;</span>    Camiâ€¦</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 81 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 4 more variables: county &lt;chr&gt;, state &lt;chr&gt;, lat &lt;dbl&gt;, lng &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data frame of unique state/county pairs</span></span>
<span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="va">stack</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">county</span><span class="op">)</span></span>
<span><span class="co"># Retrieve county FIPS codes</span></span>
<span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="va">sc</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fips <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_chr</a></span><span class="op">(</span><span class="va">sc</span><span class="op">$</span><span class="va">state</span>, <span class="va">sc</span><span class="op">$</span><span class="va">county</span>, <span class="fu">fipio</span><span class="fu">::</span><span class="va">as_fips</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `dplyr::mutate()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> In argument: `fips = purrr::map2_chr(sc$state, sc$county,</span></span>
<span><span class="co">#&gt;   fipio::as_fips)`.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `loadNamespace()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> there is no package called 'fipio'</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve geometries based on county FIPS</span></span>
<span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="va">sc</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">sc</span><span class="op">$</span><span class="va">fips</span>, <span class="fu">fipio</span><span class="fu">::</span><span class="va">fips_geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `dplyr::mutate()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> In argument: `geometry = purrr::map(sc$fips, fipio::fips_geometry)`.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `loadNamespace()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> there is no package called 'fipio'</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create `{sf}` &lt;MULTIPOLYGON&gt; object</span></span>
<span><span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">sc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error in st_sf(x, ..., agr = agr, sf_column_name = sf_column_name): no simple features geometry column present</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 53 Ã— 2</span></span></span>
<span><span class="co">#&gt;    state county   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> GA    Haralson </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> GA    Towns    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> GA    Carroll  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> GA    Bacon    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> GA    Mitchell </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> GA    Elbert   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> GA    Union    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> GA    Worth    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> GA    Jefferson</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> GA    Hancock  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 43 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="send-to-tidygeocoder">Send to <code>{tidygeocoder}</code><a class="anchor" aria-label="anchor" href="#send-to-tidygeocoder"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geo</span> <span class="op">&lt;-</span> <span class="fu">tidygeocoder</span><span class="fu">::</span><span class="fu"><a href="https://jessecambon.github.io/tidygeocoder/reference/geocode.html" class="external-link">geocode</a></span><span class="op">(</span><span class="va">stack</span>, </span>
<span>                             address <span class="op">=</span> <span class="va">address</span>, </span>
<span>                             method <span class="op">=</span> <span class="st">"mapbox"</span>, </span>
<span>                             full_results <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             unique_only <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                             return_input <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">npi</span>, <span class="va">zip</span>, <span class="va">place_name</span>, <span class="va">lat</span>, <span class="va">long</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `dplyr::select()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't subset columns that don't exist.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">âœ–</span> Column `lat` doesn't exist.</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geo</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; function (address = NULL, street = NULL, city = NULL, county = NULL, </span></span>
<span><span class="co">#&gt;     state = NULL, postalcode = NULL, country = NULL, method = "osm", </span></span>
<span><span class="co">#&gt;     cascade_order = c("census", "osm"), lat = "lat", long = "long", </span></span>
<span><span class="co">#&gt;     limit = 1, full_results = FALSE, mode = "", unique_only = FALSE, </span></span>
<span><span class="co">#&gt;     return_addresses = TRUE, min_time = NULL, progress_bar = show_progress_bar(), </span></span>
<span><span class="co">#&gt;     quiet = getOption("tidygeocoder.quiet", FALSE), api_url = NULL, </span></span>
<span><span class="co">#&gt;     timeout = 20, flatten = TRUE, batch_limit = NULL, batch_limit_error = TRUE, </span></span>
<span><span class="co">#&gt;     verbose = getOption("tidygeocoder.verbose", FALSE), no_query = FALSE, </span></span>
<span><span class="co">#&gt;     custom_query = list(), api_options = list(), return_type = "locations", </span></span>
<span><span class="co">#&gt;     iq_region = "us", geocodio_v = 1.6, param_error = TRUE, mapbox_permanent = FALSE, </span></span>
<span><span class="co">#&gt;     here_request_id = NULL, mapquest_open = FALSE) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     lat &lt;- rm_quote(deparse(substitute(lat)))</span></span>
<span><span class="co">#&gt;     long &lt;- rm_quote(deparse(substitute(long)))</span></span>
<span><span class="co">#&gt;     api_options &lt;- initialize_init(api_options)</span></span>
<span><span class="co">#&gt;     if (api_options[["init"]] == TRUE) {</span></span>
<span><span class="co">#&gt;         if (!missing("return_type") &amp;&amp; !is.null(return_type)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(return_type)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["census_return_type"]] &lt;- return_type</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (!missing("iq_region") &amp;&amp; !is.null(iq_region)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(iq_region)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["iq_region"]] &lt;- iq_region</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (!missing("geocodio_v") &amp;&amp; !is.null(geocodio_v)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(geocodio_v)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["geocodio_v"]] &lt;- geocodio_v</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (!missing("mapbox_permanent") &amp;&amp; !is.null(mapbox_permanent)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(mapbox_permanent)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["mapbox_permanent"]] &lt;- mapbox_permanent</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (!missing("mapquest_open") &amp;&amp; !is.null(mapquest_open)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(mapquest_open)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["mapquest_open"]] &lt;- mapquest_open</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (!missing("here_request_id") &amp;&amp; !is.null(here_request_id)) {</span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(here_request_id)", </span></span>
<span><span class="co">#&gt;                 with = "geo(api_options)")</span></span>
<span><span class="co">#&gt;             api_options[["here_request_id"]] &lt;- here_request_id</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     api_options &lt;- apply_api_options_defaults(api_options)</span></span>
<span><span class="co">#&gt;     all_args &lt;- as.list(environment())</span></span>
<span><span class="co">#&gt;     if (method != "cascade") {</span></span>
<span><span class="co">#&gt;         all_args$api_options[["init"]] &lt;- FALSE</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         lifecycle::deprecate_warn("1.0.4", "geo(method = \"cannot be \\\"cascade\\\"\")", </span></span>
<span><span class="co">#&gt;             "geocode_combine()")</span></span>
<span><span class="co">#&gt;         all_args$return_type &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$iq_region &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$geocodio_v &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$mapbox_permanent &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$mapquest_open &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$here_request_id &lt;- NULL</span></span>
<span><span class="co">#&gt;         all_args$api_options$cascade_flag &lt;- TRUE</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     check_api_options(api_options, "geo")</span></span>
<span><span class="co">#&gt;     if (is.null(address) &amp;&amp; is.null(street) &amp;&amp; is.null(city) &amp;&amp; </span></span>
<span><span class="co">#&gt;         is.null(county) &amp;&amp; is.null(state) &amp;&amp; is.null(postalcode) &amp;&amp; </span></span>
<span><span class="co">#&gt;         is.null(country)) {</span></span>
<span><span class="co">#&gt;         stop("No address data provided", call. = FALSE)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(address, "address")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(street, "street")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(city, "city")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(county, "county")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(state, "state")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(postalcode, "postalcode")</span></span>
<span><span class="co">#&gt;     check_address_argument_datatype(country, "country")</span></span>
<span><span class="co">#&gt;     if (!(api_options[["census_return_type"]] %in% c("geographies", </span></span>
<span><span class="co">#&gt;         "locations"))) {</span></span>
<span><span class="co">#&gt;         stop("Invalid return_type argument. See ?geo", call. = FALSE)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     stopifnot(is.logical(verbose), is.logical(no_query), is.logical(flatten), </span></span>
<span><span class="co">#&gt;         is.null(param_error) || is.logical(param_error), is.logical(full_results), </span></span>
<span><span class="co">#&gt;         is.logical(unique_only), is.logical(return_addresses), </span></span>
<span><span class="co">#&gt;         is.null(batch_limit_error) || is.logical(batch_limit_error), </span></span>
<span><span class="co">#&gt;         is.logical(progress_bar), is.logical(quiet), is.numeric(timeout), </span></span>
<span><span class="co">#&gt;         timeout &gt;= 0, is.list(custom_query), is.logical(api_options[["mapbox_permanent"]]), </span></span>
<span><span class="co">#&gt;         is.null(api_options[["here_request_id"]]) || is.character(api_options[["here_request_id"]]), </span></span>
<span><span class="co">#&gt;         is.logical(api_options[["mapquest_open"]]), is.logical(api_options[["geocodio_hipaa"]]))</span></span>
<span><span class="co">#&gt;     check_verbose_quiet(verbose, quiet, reverse = FALSE)</span></span>
<span><span class="co">#&gt;     check_common_args("geo", mode, limit, batch_limit, min_time)</span></span>
<span><span class="co">#&gt;     check_method(method, reverse = FALSE, mode, batch_func_map, </span></span>
<span><span class="co">#&gt;         cascade_order = cascade_order)</span></span>
<span><span class="co">#&gt;     if (!(api_options[["census_return_type"]] %in% c("geographies", </span></span>
<span><span class="co">#&gt;         "locations"))) {</span></span>
<span><span class="co">#&gt;         stop("Invalid census_return_type value. See ?geo", call. = FALSE)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (api_options[["init"]] == TRUE) {</span></span>
<span><span class="co">#&gt;         if (!missing("cascade_order")) </span></span>
<span><span class="co">#&gt;             lifecycle::deprecate_warn("1.0.4", "geo(cascade_order)", </span></span>
<span><span class="co">#&gt;                 "geocode_combine()")</span></span>
<span><span class="co">#&gt;         if (is.null(api_options[["cascade_flag"]]) || api_options[["cascade_flag"]] != </span></span>
<span><span class="co">#&gt;             TRUE) {</span></span>
<span><span class="co">#&gt;             if (!missing("batch_limit_error")) </span></span>
<span><span class="co">#&gt;                 lifecycle::deprecate_warn("1.0.4", "geo(batch_limit_error)")</span></span>
<span><span class="co">#&gt;             if (!missing("param_error")) </span></span>
<span><span class="co">#&gt;                 lifecycle::deprecate_warn("1.0.4", "geo(param_error)")</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (no_query == TRUE) </span></span>
<span><span class="co">#&gt;         verbose &lt;- TRUE</span></span>
<span><span class="co">#&gt;     start_time &lt;- Sys.time()</span></span>
<span><span class="co">#&gt;     address_pack &lt;- package_addresses(address, street, city, </span></span>
<span><span class="co">#&gt;         county, state, postalcode, country)</span></span>
<span><span class="co">#&gt;     num_unique_addresses &lt;- nrow(address_pack$unique)</span></span>
<span><span class="co">#&gt;     NA_value &lt;- get_na_value(lat, long, rows = num_unique_addresses)</span></span>
<span><span class="co">#&gt;     if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;         message(paste0("\nNumber of Unique Addresses: ", num_unique_addresses))</span></span>
<span><span class="co">#&gt;     if (num_unique_addresses == 1 &amp;&amp; all(is.na(address_pack$unique))) {</span></span>
<span><span class="co">#&gt;         if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;             message(paste0("No non-blank non-NA addreses found. Returning NA results."))</span></span>
<span><span class="co">#&gt;         return(unpackage_inputs(address_pack, NA_value, unique_only, </span></span>
<span><span class="co">#&gt;             return_addresses))</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (method == "cascade") {</span></span>
<span><span class="co">#&gt;         legal_parameters &lt;- unique(c(get_generic_parameters(cascade_order[1]), </span></span>
<span><span class="co">#&gt;             get_generic_parameters(cascade_order[2])))</span></span>
<span><span class="co">#&gt;         str_cascade_meth &lt;- paste0(" (\"", paste0(cascade_order, </span></span>
<span><span class="co">#&gt;             collapse = "\", \""), "\")")</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         legal_parameters &lt;- get_generic_parameters(method)</span></span>
<span><span class="co">#&gt;         str_cascade_meth &lt;- ""</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     illegal_params &lt;- c()</span></span>
<span><span class="co">#&gt;     for (param in colnames(address_pack$unique)) {</span></span>
<span><span class="co">#&gt;         if (!(param %in% legal_parameters)) {</span></span>
<span><span class="co">#&gt;             illegal_params &lt;- c(illegal_params, param)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (length(illegal_params) &gt; 0) {</span></span>
<span><span class="co">#&gt;         param_message &lt;- paste0("The following parameter(s) are not supported for the \"", </span></span>
<span><span class="co">#&gt;             method, "\"", str_cascade_meth, " method:\n\n", paste0(illegal_params, </span></span>
<span><span class="co">#&gt;                 collapse = " "), "\n\nSee ?api_parameter_reference for more details.")</span></span>
<span><span class="co">#&gt;         if (is.null(param_error) || param_error == TRUE) </span></span>
<span><span class="co">#&gt;             stop(param_message, call. = FALSE)</span></span>
<span><span class="co">#&gt;         else if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;             message(param_message)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (method == "cascade") {</span></span>
<span><span class="co">#&gt;         if (full_results == TRUE) </span></span>
<span><span class="co">#&gt;             stop("full_results = TRUE cannot be used with the cascade method.", </span></span>
<span><span class="co">#&gt;                 call. = FALSE)</span></span>
<span><span class="co">#&gt;         if (is.null(limit) || limit != 1) </span></span>
<span><span class="co">#&gt;             stop("limit argument must be 1 (default) to use the cascade method.", </span></span>
<span><span class="co">#&gt;                 call. = FALSE)</span></span>
<span><span class="co">#&gt;         return(do.call(cascade_geocoding, c(all_args[!names(all_args) %in% </span></span>
<span><span class="co">#&gt;             c("method", "param_error", "batch_limit_error")], </span></span>
<span><span class="co">#&gt;             list(batch_limit_error = FALSE, param_error = FALSE))))</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (method %in% pkg.globals$single_first_methods &amp;&amp; mode != </span></span>
<span><span class="co">#&gt;         "batch") {</span></span>
<span><span class="co">#&gt;         mode &lt;- "single"</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     single_addr_args &lt;- c(list(FUN = progress_geo), as.list(address_pack$unique), </span></span>
<span><span class="co">#&gt;         list(MoreArgs = all_args[!names(all_args) %in% pkg.globals$address_arg_names], </span></span>
<span><span class="co">#&gt;             USE.NAMES = FALSE, SIMPLIFY = FALSE))</span></span>
<span><span class="co">#&gt;     if ((api_options[["init"]] == TRUE) &amp;&amp; (mode != "batch") &amp;&amp; </span></span>
<span><span class="co">#&gt;         (!(method %in% names(batch_func_map)) || ((num_unique_addresses == </span></span>
<span><span class="co">#&gt;             1) || (mode == "single")))) {</span></span>
<span><span class="co">#&gt;         if (quiet == FALSE) {</span></span>
<span><span class="co">#&gt;             query_start_message(method, num_unique_addresses, </span></span>
<span><span class="co">#&gt;                 reverse = FALSE, batch = FALSE)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (progress_bar == TRUE) {</span></span>
<span><span class="co">#&gt;             pb &lt;- create_progress_bar(num_unique_addresses)</span></span>
<span><span class="co">#&gt;             single_addr_args$MoreArgs$pb &lt;- pb</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         list_coords &lt;- do.call(mapply, single_addr_args)</span></span>
<span><span class="co">#&gt;         if (quiet == FALSE &amp;&amp; progress_bar == FALSE) {</span></span>
<span><span class="co">#&gt;             query_complete_message(start_time)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         stacked_results &lt;- dplyr::bind_rows(list_coords)</span></span>
<span><span class="co">#&gt;         return(unpackage_inputs(address_pack, stacked_results, </span></span>
<span><span class="co">#&gt;             unique_only, FALSE))</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (api_options[["init"]] == TRUE) {</span></span>
<span><span class="co">#&gt;         if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;             message("Executing batch geocoding...\n")</span></span>
<span><span class="co">#&gt;         check_limit_for_batch(limit, return_addresses, reverse = FALSE)</span></span>
<span><span class="co">#&gt;         if (is.null(batch_limit)) </span></span>
<span><span class="co">#&gt;             batch_limit &lt;- get_batch_limit(method)</span></span>
<span><span class="co">#&gt;         if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;             message(paste0("Batch limit: ", format(batch_limit, </span></span>
<span><span class="co">#&gt;                 big.mark = ",")))</span></span>
<span><span class="co">#&gt;         if (num_unique_addresses &gt; batch_limit) {</span></span>
<span><span class="co">#&gt;             batch_limit_exceeded &lt;- TRUE</span></span>
<span><span class="co">#&gt;             batch_limit_exceeded_message &lt;- paste0(format(num_unique_addresses, </span></span>
<span><span class="co">#&gt;                 big.mark = ","), " unique addresses found which exceeds the batch limit of ", </span></span>
<span><span class="co">#&gt;                 format(batch_limit, big.mark = ","), ".")</span></span>
<span><span class="co">#&gt;             if (batch_limit_error == TRUE) </span></span>
<span><span class="co">#&gt;                 stop(batch_limit_exceeded_message, call. = FALSE)</span></span>
<span><span class="co">#&gt;             else {</span></span>
<span><span class="co">#&gt;                 warning(paste0(batch_limit_exceeded_message, </span></span>
<span><span class="co">#&gt;                   "\n", "Only geocoding the first ", format(batch_limit, </span></span>
<span><span class="co">#&gt;                     big.mark = ","), " unique addresses. ", "All other addresses will have NA results."))</span></span>
<span><span class="co">#&gt;                 batch_unique_addresses &lt;- address_pack$unique[1:batch_limit, </span></span>
<span><span class="co">#&gt;                   ]</span></span>
<span><span class="co">#&gt;             }</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         else {</span></span>
<span><span class="co">#&gt;             batch_limit_exceeded &lt;- FALSE</span></span>
<span><span class="co">#&gt;             batch_unique_addresses &lt;- address_pack$unique</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (method == "here") </span></span>
<span><span class="co">#&gt;             check_here_return_input(api_options[["here_request_id"]], </span></span>
<span><span class="co">#&gt;                 return_addresses, reverse = FALSE)</span></span>
<span><span class="co">#&gt;         if (quiet == FALSE) {</span></span>
<span><span class="co">#&gt;             query_start_message(method, min(batch_limit, num_unique_addresses), </span></span>
<span><span class="co">#&gt;                 reverse = FALSE, batch = TRUE, display_time = FALSE)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (no_query == TRUE) </span></span>
<span><span class="co">#&gt;             return(unpackage_inputs(address_pack, NA_value, unique_only, </span></span>
<span><span class="co">#&gt;                 return_addresses))</span></span>
<span><span class="co">#&gt;         batch_results &lt;- do.call(batch_func_map[[method]], c(list(batch_unique_addresses), </span></span>
<span><span class="co">#&gt;             all_args[!names(all_args) %in% pkg.globals$address_arg_names]))</span></span>
<span><span class="co">#&gt;         if (batch_limit_exceeded == TRUE) {</span></span>
<span><span class="co">#&gt;             batch_filler &lt;- get_na_value(lat, long, rows = num_unique_addresses - </span></span>
<span><span class="co">#&gt;                 batch_limit)</span></span>
<span><span class="co">#&gt;             batch_results &lt;- dplyr::bind_rows(batch_results, </span></span>
<span><span class="co">#&gt;                 batch_filler)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         if (quiet == FALSE) {</span></span>
<span><span class="co">#&gt;             query_complete_message(start_time)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         return(unpackage_inputs(address_pack, batch_results, </span></span>
<span><span class="co">#&gt;             unique_only, return_addresses))</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     generic_query &lt;- list()</span></span>
<span><span class="co">#&gt;     if (!is.null(address)) {</span></span>
<span><span class="co">#&gt;         search &lt;- "onelineaddress"</span></span>
<span><span class="co">#&gt;         generic_query[["address"]] &lt;- address_pack$unique$address</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         search &lt;- "address"</span></span>
<span><span class="co">#&gt;         if (!is.null(street)) </span></span>
<span><span class="co">#&gt;             generic_query[["street"]] &lt;- address_pack$unique$street</span></span>
<span><span class="co">#&gt;         if (!is.null(city)) </span></span>
<span><span class="co">#&gt;             generic_query[["city"]] &lt;- address_pack$unique$city</span></span>
<span><span class="co">#&gt;         if (!is.null(county)) </span></span>
<span><span class="co">#&gt;             generic_query[["county"]] &lt;- address_pack$unique$county</span></span>
<span><span class="co">#&gt;         if (!is.null(state)) </span></span>
<span><span class="co">#&gt;             generic_query[["state"]] &lt;- address_pack$unique$state</span></span>
<span><span class="co">#&gt;         if (!is.null(postalcode)) </span></span>
<span><span class="co">#&gt;             generic_query[["postalcode"]] &lt;- address_pack$unique$postalcode</span></span>
<span><span class="co">#&gt;         if (!is.null(country)) </span></span>
<span><span class="co">#&gt;             generic_query[["country"]] &lt;- address_pack$unique$country</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (is.null(api_url)) {</span></span>
<span><span class="co">#&gt;         api_url &lt;- get_api_url(method, reverse = FALSE, return_type = api_options[["census_return_type"]], </span></span>
<span><span class="co">#&gt;             search = search, geocodio_v = api_options[["geocodio_v"]], </span></span>
<span><span class="co">#&gt;             iq_region = api_options[["iq_region"]], mapbox_permanent = api_options[["mapbox_permanent"]], </span></span>
<span><span class="co">#&gt;             mapquest_open = api_options[["mapquest_open"]], geocodio_hipaa = api_options[["geocodio_hipaa"]])</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     api_url &lt;- api_url_modification(method, api_url, generic_query, </span></span>
<span><span class="co">#&gt;         custom_query, reverse = FALSE)</span></span>
<span><span class="co">#&gt;     if (is.null(min_time)) </span></span>
<span><span class="co">#&gt;         min_time &lt;- get_min_query_time(method)</span></span>
<span><span class="co">#&gt;     generic_query &lt;- add_common_generic_parameters(generic_query, </span></span>
<span><span class="co">#&gt;         method, no_query, limit)</span></span>
<span><span class="co">#&gt;     api_query_parameters &lt;- get_api_query(method, generic_query, </span></span>
<span><span class="co">#&gt;         custom_query)</span></span>
<span><span class="co">#&gt;     if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;         display_query(api_url, api_query_parameters)</span></span>
<span><span class="co">#&gt;     if (no_query == TRUE) </span></span>
<span><span class="co">#&gt;         return(unpackage_inputs(address_pack, NA_value, unique_only, </span></span>
<span><span class="co">#&gt;             return_addresses))</span></span>
<span><span class="co">#&gt;     query_results &lt;- query_api(api_url, api_query_parameters, </span></span>
<span><span class="co">#&gt;         method = method)</span></span>
<span><span class="co">#&gt;     if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;         message(paste0("HTTP Status Code: ", as.character(query_results$status)))</span></span>
<span><span class="co">#&gt;     if (query_results$status != 200) {</span></span>
<span><span class="co">#&gt;         extract_errors_from_results(method, query_results$content, </span></span>
<span><span class="co">#&gt;             verbose)</span></span>
<span><span class="co">#&gt;         results &lt;- NA_value</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     else {</span></span>
<span><span class="co">#&gt;         results &lt;- extract_results(method, jsonlite::fromJSON(query_results$content), </span></span>
<span><span class="co">#&gt;             full_results, flatten, limit)</span></span>
<span><span class="co">#&gt;         names(results)[1] &lt;- lat</span></span>
<span><span class="co">#&gt;         names(results)[2] &lt;- long</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     pause_until(start_time, min_time, debug = verbose)</span></span>
<span><span class="co">#&gt;     if (verbose == TRUE) </span></span>
<span><span class="co">#&gt;         message("")</span></span>
<span><span class="co">#&gt;     return(unpackage_inputs(address_pack, results, unique_only, </span></span>
<span><span class="co">#&gt;         return_addresses))</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x556042e6a670&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:tidygeocoder&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="convert-to-sf-object">Convert to <code>{sf}</code> object<a class="anchor" aria-label="anchor" href="#convert-to-sf-object"></a>
</h2>
</div>
<div class="section level2">
<h2 id="retrieve-georgia-state-counties-shapefile-from-tigris">Retrieve Georgia state &amp; counties shapefile from
<code>{tigris}</code><a class="anchor" aria-label="anchor" href="#retrieve-georgia-state-counties-shapefile-from-tigris"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ga_state</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/states.html" class="external-link">states</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2022</span>, </span>
<span>                           progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STUSPS</span> <span class="op">==</span> <span class="st">"GA"</span><span class="op">)</span></span>
<span><span class="va">ga_state</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 1 feature and 14 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -85.60516 ymin: 30.35576 xmax: -80.78296 ymax: 35.0013</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span><span class="co">#&gt;   REGION DIVISION STATEFP  STATENS GEOID STUSPS    NAME LSAD MTFCC FUNCSTAT</span></span>
<span><span class="co">#&gt; 1      3        5      13 01705317    13     GA Georgia   00 G4000        A</span></span>
<span><span class="co">#&gt;          ALAND     AWATER    INTPTLAT     INTPTLON</span></span>
<span><span class="co">#&gt; 1 149486268417 4418716153 +32.6295789 -083.4235109</span></span>
<span><span class="co">#&gt;                         geometry</span></span>
<span><span class="co">#&gt; 1 MULTIPOLYGON (((-81.09538 3...</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ga_counties</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span>state <span class="op">=</span> <span class="st">"GA"</span>, </span>
<span>                                year <span class="op">=</span> <span class="fl">2022</span>, </span>
<span>                                progress_bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span><span class="va">ga_counties</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Simple feature collection with 159 features and 17 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -85.60516 ymin: 30.35576 xmax: -80.78296 ymax: 35.0013</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD83</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;     STATEFP COUNTYFP COUNTYNS GEOID     NAME        NAMELSAD LSAD CLASSFP MTFCC</span></span>
<span><span class="co">#&gt; 16       13      189 00348794 13189 McDuffie McDuffie County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 53       13      025 00351605 13025 Brantley Brantley County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 54       13      171 00326713 13171    Lamar    Lamar County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 83       13      115 00353665 13115    Floyd    Floyd County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 101      13      273 00352238 13273  Terrell  Terrell County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 102      13      063 01672399 13063  Clayton  Clayton County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 105      13      073 00348865 13073 Columbia Columbia County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 126      13      193 00346957 13193    Macon    Macon County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 146      13      049 00357747 13049 Charlton Charlton County   06      H1 G4020</span></span>
<span><span class="co">#&gt; 147      13      233 00343585 13233     Polk     Polk County   06      H1 G4020</span></span>
<span><span class="co">#&gt;     CSAFP CBSAFP METDIVFP FUNCSTAT      ALAND   AWATER    INTPTLAT     INTPTLON</span></span>
<span><span class="co">#&gt; 16   &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  666591525 23112523 +33.4806126 -082.4795333</span></span>
<span><span class="co">#&gt; 53   &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A 1147972258 10291563 +31.1973339 -081.9829779</span></span>
<span><span class="co">#&gt; 54   &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  475264405  6044329 +33.0744405 -084.1466893</span></span>
<span><span class="co">#&gt; 83   &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A 1320431515 22387093 +34.2636901 -085.2136849</span></span>
<span><span class="co">#&gt; 101  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  869695791  4951325 +31.7771909 -084.4394464</span></span>
<span><span class="co">#&gt; 102  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  367145192  6928044 +33.5516027 -084.4128678</span></span>
<span><span class="co">#&gt; 105  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  751598754 45345677 +33.5520746 -082.2496077</span></span>
<span><span class="co">#&gt; 126  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A 1037709945 13841916 +32.3626859 -084.0512306</span></span>
<span><span class="co">#&gt; 146  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A 2020415648  5963237 +30.7799036 -082.1396442</span></span>
<span><span class="co">#&gt; 147  &lt;NA&gt;   &lt;NA&gt;     &lt;NA&gt;        A  803775591  4664760 +33.9960153 -085.1883384</span></span>
<span><span class="co">#&gt;                           geometry</span></span>
<span><span class="co">#&gt; 16  MULTIPOLYGON (((-82.6497 33...</span></span>
<span><span class="co">#&gt; 53  MULTIPOLYGON (((-81.91301 3...</span></span>
<span><span class="co">#&gt; 54  MULTIPOLYGON (((-84.2484 33...</span></span>
<span><span class="co">#&gt; 83  MULTIPOLYGON (((-85.02322 3...</span></span>
<span><span class="co">#&gt; 101 MULTIPOLYGON (((-84.3052 31...</span></span>
<span><span class="co">#&gt; 102 MULTIPOLYGON (((-84.45843 3...</span></span>
<span><span class="co">#&gt; 105 MULTIPOLYGON (((-82.44285 3...</span></span>
<span><span class="co">#&gt; 126 MULTIPOLYGON (((-83.83685 3...</span></span>
<span><span class="co">#&gt; 146 MULTIPOLYGON (((-82.42036 3...</span></span>
<span><span class="co">#&gt; 147 MULTIPOLYGON (((-85.16059 3...</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co">#ggplot2::geom_sf(data = ga_state, colour = "darkred") +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ga_counties</span>, fill <span class="op">=</span> <span class="st">"darkgreen"</span>, colour <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sc</span>, size <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="va">geo</span>, </span>
<span>                      mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span><span class="op">)</span>, </span>
<span>                      fill <span class="op">=</span> <span class="st">"orange"</span>, </span>
<span>                      color <span class="op">=</span> <span class="st">"darkred"</span>, </span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>                      size <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>                      shape <span class="op">=</span> <span class="fl">21</span>, </span>
<span>                      stroke <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_label_repel(rhc_crd, </span></span>
<span>  <span class="co">#                 mapping = aes(long, lat, label = organization),</span></span>
<span>  <span class="co">#                 force_pull = 0,</span></span>
<span>  <span class="co">#                 force = 2,</span></span>
<span>  <span class="co">#                 direction = "both",</span></span>
<span>  <span class="co">#                 segment.curvature = -0.1, </span></span>
<span>  <span class="co">#                 segment.ncp = 3, </span></span>
<span>  <span class="co">#                 segment.angle = 20, </span></span>
<span>  <span class="co">#                 min.segment.length = 0,</span></span>
<span>  <span class="co">#                 nudge_x = 2.5,</span></span>
<span>  <span class="co">#                 nudge_y = 0.5) +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu">ggsflabel</span><span class="fu">::</span><span class="fu"><a href="https://yutannihilation.github.io/ggsflabel/reference/lims_bbox.html" class="external-link">lims_bbox</a></span><span class="op">(</span><span class="va">ga_counties</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `ggplot2::geom_point()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Problem while computing layer data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Error occurred in the 3rd layer.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in `if (...) NULL`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> missing value where TRUE/FALSE needed</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrew Bruce.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
