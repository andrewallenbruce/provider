---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse  = TRUE,
  echo      = FALSE, 
  message   = FALSE, 
  warning   = FALSE,
  error     = TRUE,
  comment   = "#>",
  dpi       = 150, 
  out.width = "100%",
  fig.path  = "man/figures/README-"
)
```

# `provider` <img src="man/figures/logo.svg" align="right" height="200" />

<!-- badges: start -->
[![R-CMD-check](https://github.com/andrewallenbruce/provider/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/andrewallenbruce/provider/actions/workflows/R-CMD-check.yaml)
[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip)
[![License: MIT](https://img.shields.io/badge/license-MIT-blue.svg)](https://choosealicense.com/licenses/mit/)
[![code size](https://img.shields.io/github/languages/code-size/andrewallenbruce/provider.svg)](https://github.com/andrewallenbruce/provider)
[![last commit](https://img.shields.io/github/last-commit/andrewallenbruce/provider.svg)](https://github.com/andrewallenbruce/provider/commits/main)
[![Codecov test coverage](https://codecov.io/gh/andrewallenbruce/provider/branch/main/graph/badge.svg)](https://app.codecov.io/gh/andrewallenbruce/provider?branch=main)
[![CodeFactor](https://www.codefactor.io/repository/github/andrewallenbruce/provider/badge)](https://www.codefactor.io/repository/github/andrewallenbruce/provider)
<!-- badges: end -->

The goal of `provider` is to provide performant and reliable open-source tools to facilitate easy access to [healthcare provider](https://en.wikipedia.org/wiki/Health_care_provider) data through publicly available APIs & sources. The current list of supported APIs are:

<br>
   *  [Medicare Provider and Supplier Taxonomy Crosswalk API](https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/medicare-provider-and-supplier-taxonomy-crosswalk)
   *  [Medicare Revalidation Due Date API](https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/revalidation-due-date-list)
   *  [Medicare Revalidation Clinic Group Practice Reassignment API](https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/revalidation-clinic-group-practice-reassignment)
   *  [CMS Public Reporting of Missing Digital Contact Information API](https://data.cms.gov/provider-compliance/public-reporting-of-missing-digital-contact-information)
   *  [Medicare Physician & Other Practitioners API](https://data.cms.gov/provider-summary-by-type-of-service/medicare-physician-other-practitioners/medicare-physician-other-practitioners-by-provider-and-service)
   *  [Medicare Market Saturation & Utilization State-County API](https://data.cms.gov/summary-statistics-on-use-and-payments/program-integrity-market-saturation-by-type-of-service/market-saturation-utilization-state-county)
   *  [Medicare Provider of Services File - Clinical Laboratories API](https://data.cms.gov/provider-characteristics/hospitals-and-other-facilities/provider-of-services-file-clinical-laboratories)
 
<br>

```{r results='asis', echo=FALSE}
# Informational APIs
nppes_func <- gluedown::md_code("nppes_npi()")
nppes_link <- gluedown::md_link("NPPES National Provider Identifier (NPI) Registry" = "https://npiregistry.cms.hhs.gov/search")

mppe_func <- gluedown::md_code("provider_enrollment()")
mppe_link <- gluedown::md_link("Medicare Fee-For-Service Public Provider Enrollment" = "https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/medicare-fee-for-service-public-provider-enrollment")

order_func <- gluedown::md_code("order_refer()")
order_link <- gluedown::md_link("Medicare Order and Referring" = "https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/order-and-referring")

opt_func <- gluedown::md_code("opt_out()")
opt_link <- gluedown::md_link("Medicare Opt Out Affidavits" = "https://data.cms.gov/provider-characteristics/medicare-provider-supplier-enrollment/opt-out-affidavits")

# Statistical APIs
pbs_link <- gluedown::md_link("Medicare Physician & Other Practitioners: by Provider and Service" = "https://data.cms.gov/provider-summary-by-type-of-service/medicare-physician-other-practitioners/medicare-physician-other-practitioners-by-provider-and-service")
pbs_func <- gluedown::md_code("physician_by_service()")

gluedown::md_table(data.frame(
  Function = c(nppes_func, 
               mppe_func, 
               order_func,
               opt_func,
               pbs_func), 
  API = c(nppes_link, 
          mppe_link, 
          order_link,
          opt_link,
          pbs_link)))
```


## Installation

You can install the development version of `provider` from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("andrewallenbruce/provider")

# install.packages("remotes")
remotes::install_github("andrewallenbruce/provider")
```
<br>

## Provider Information

These APIs are generally concerned with providing access to up-to-date information a provider or her associates may need for many aspects of the transacting of healthcare.

### NPPES NPI Public Registry

<br>

```{r, echo=TRUE}
# Load library
library(provider)

# Define search parameter
npi <- 1083879860

# Query the NPPES API and unpack the response
nppes_ex <- provider_nppes(npi) |> 
            provider_unpack()
```

<br>

```{r results='asis', echo=FALSE}
gluedown::md_heading("Basic Information", level = 1)
gluedown::md_table(nppes_ex[, 1:5] |> dplyr::slice_head())
gluedown::md_blank()
gluedown::md_table(nppes_ex[, 6:10] |> dplyr::slice_head())
gluedown::md_rule(n = 60)
gluedown::md_heading("Addresses", level = 1)
gluedown::md_table(nppes_ex[, 13:17])
gluedown::md_blank()
gluedown::md_heading("Taxonomy", level = 1)
gluedown::md_table(nppes_ex[, 18:23] |> dplyr::slice_head())
gluedown::md_blank()
gluedown::md_heading("Endpoints", level = 1)
gluedown::md_table(nppes_ex[, 24:26] |> dplyr::slice_head())
gluedown::md_blank()
gluedown::md_table(nppes_ex[, 27:28] |> dplyr::slice_head())
gluedown::md_blank()
gluedown::md_table(nppes_ex[, 35:38] |> dplyr::slice_head())
```

<br>

### FFS Public Provider Enrollment

What if you need the provider's PECOS PAC ID or Enrollment ID? Using the `provider_mppe()` function, you can search Medicare's **Fee-For-Service Public Provider Enrollment API**:

<br>

```{r echo=TRUE}
mppe_ex <- provider_mppe(npi)
```


<br>

```{r results='asis'}
gluedown::md_table(list(mppe_ex[, 1:4], mppe_ex[, 5:9]), caption = "Title of the table", longtable = TRUE)
```

<br>

### Order and Referring

Is a Provider currently eligible to:

```{r results='asis', echo=FALSE}
gluedown::md_bullet(list("Make referrals to Medicare Part B or a Home Health Agency (HHA)?", "Order Durable Medical Equipment (DME) or Power Mobility Devices (PMDs)? "), marker = "-")
```

Search Medicare's **Order and Referring API** with `order_refer()`:


```{r results='asis'}
order_refer(npi) |> gluedown::md_table()
```

<br>

### Taxonomy Crosswalk

You may need to find Medicare's specialty codes for this provider's taxonomies. You can search Medicare's **Provider and Supplier Taxonomy Crosswalk API** with `provider_mpstc()`:

<br>

```{r results='asis'}
provider_mpstc(nppes_ex[1,]$taxon_code) |> gluedown::md_table()
```

<br>

### Revalidation Due Date

You can check to see if a provider is due to revalidate their Medicare enrollment by accessing Medicare's **Revalidation Due Date API** with `provider_mrdd()`:

<br>

```{r results='asis'}
provider_mrdd(npi) |> gluedown::md_table()
```

<br>

### Missing Digital Contact Information

Providers may need to update their digital contact information in the NPPES system. To check, you can access the **CMS Public Reporting of Missing Digital Contact Information API** with `provider_promdci()`. If they appear in the search results, it's time to update their NPPES contact information:

<br>

```{r results='asis'}
provider_promdci(1144224569) |> gluedown::md_table()
```

<br>

### Opt-Out Affidavits

You can find out if a provider has opted out of Medicare by searching the **Medicare Opt Out Affidavits API** with `opt_out()`:

<br>

```{r results='asis'}
opt_out(last = "Aaron") |> gluedown::md_table()
```

<br>

### Revalidation Clinic Group Practice Reassignment

`provider_rcgpr()` accesses **Medicare's Revalidation Clinic Group Practice Reassignment API**:

<br>

```{r}
provider_rcgpr(npi)
```


## Provider Statistics

These APIs are generally concerned with providing access to a provider's longitudinal utilization data.

### Physician & Other Practitioners

```{r results='asis', echo=FALSE}
gluedown::md_quote("by Provider and Service API")
```

```{r}
serv_ex <- purrr::map_dfr(as.character(2013:2020), 
                          ~physician_by_service(
                            npi = 1003000126, 
                            year = .x))
```

```{r results='asis', echo=FALSE}
serv_ex |> 
  dplyr::select(year, 
                hcpcs_cd, 
                tot_benes, 
                tot_srvcs, 
                avg_sbmtd_chrg, 
                avg_mdcr_alowd_amt, 
                avg_mdcr_pymt_amt) |> 
  gluedown::md_table()
```


> 2. by Geography and Service API:

<br>

```{r}
# mpop_geo_ex <- provider_mpop(hcpcs   = "99214", 
#                              set     = "geo",
#                              geo_lvl = "National",
#                              year    = "2020")
```

> 3. by Provider API:

<br>

```{r}
# mpop_prov_ex <- provider_mpop(npi  = npi, 
#                               set  = "prov",
#                               year = "2020")
```

### Medicare Monthly Enrollment

```{r echo=TRUE}
month_ex <- monthly_enroll(year      = 2018, 
                           month     = "Year", 
                           geo_lvl   = "County", 
                           state_abb = "AL", 
                           county    = "Autauga")
```


```{r results='asis', echo=FALSE}
gluedown::md_table(month_ex[, 1:7])
gluedown::md_blank()
gluedown::md_table(month_ex[, 8:13])
gluedown::md_blank()
gluedown::md_table(month_ex[, 14:18])
gluedown::md_blank()
gluedown::md_table(month_ex[, 19:22])
```

------------------------------------------------------------------------------

## Code of Conduct

Please note that the provider project is released with a [Contributor Code of Conduct](https://andrewallenbruce.github.io/provider/CODE_OF_CONDUCT.html). By contributing to this project, you agree to abide by its terms.
